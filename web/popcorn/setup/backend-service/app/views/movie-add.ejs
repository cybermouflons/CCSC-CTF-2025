<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add New Movie</title>
  <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>

  <!-- Top Navbar -->
  <div class="navbar">
    <a href="/movies">Home</a>
    <a href="/movies/add">Add new movie</a>
    <a href="/profile">Profile</a>
  </div>

  <h1 style="text-align: center;">Add a New Movie</h1>

  <form id="add-movie-form" style="text-align: center; max-width: 500px; margin: auto;">
    <label for="title">Title:</label><br>
    <input type="text" id="title" name="title" required style="width: 100%; padding: 8px;"><br><br>
  
    <label for="image">Image URL:</label><br>
    <input type="text" id="image" name="image" required style="width: 100%; padding: 8px;"><br><br>
  
    <label for="trailer">Trailer Embed URL:</label><br>
    <input type="text" id="trailer" name="trailer" required style="width: 100%; padding: 8px;"><br><br>
  
    <label for="description">Description:</label><br>
    <textarea id="description" name="description" rows="4" required style="width: 100%; padding: 8px;"></textarea><br><br>
  
    <button type="submit" style="padding: 10px 20px;">Add Movie</button>
  </form>

  <div style="text-align: center; margin-top: 20px;">
    <a href="/movies">‚Üê Back to movies</a>
  </div>

  <footer style="text-align: center; padding: 20px; color: #242323; font-size: 14px;">
    &copy; CYberMouflons 2025
  </footer>

  <script>
    document.getElementById('add-movie-form').addEventListener('submit', async function (e) {
      e.preventDefault();

      const formData = {
        title: document.getElementById('title').value.trim(),
        image: document.getElementById('image').value.trim(),
        trailer: document.getElementById('trailer').value.trim(),
        description: document.getElementById('description').value.trim()
      };

      const response = await fetch('/movies', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
      });

      if (response.redirected) {
        window.location.href = response.url;
      } else {
        const result = await response.json();
        alert(result.message || "Something went wrong");
      }
    });
  </script>
</body>
</html>